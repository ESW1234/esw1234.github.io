<html>
<body>
<button onclick="toggleDeployment()">Toggle Guest -> Verified Deployment</button>
<script type='text/javascript'>

	function toggleDeployment() {
  		embeddedservice_bootstrap.userVerificationAPI.clearSession(true).then(() => {
		  embeddedservice_bootstrap.utilAPI
				.removeAllComponents()
				.then(() => {
	    			loadInitScript(false);
	  			});
		});
	};

    function initEmbeddedMessaging(deploymentName, siteUrl) {
  		try {
  			embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'
  			embeddedservice_bootstrap.settings.devMode = true;
  
  			embeddedservice_bootstrap.init(
  				'00DSB00000aGFJL',
  				deploymentName,
  				siteUrl,
  				{
  					scrt2URL: 'https://orgfarm-d585323017.test1.my.pc-rnd.salesforce-scrt.com'
  				}
  			);
  		} catch (err) {
  			console.error('Error loading Embedded Messaging: ', err);
  		}
	};
  
    function loadInitScript(isGuest = true) {
		const deploymentName = isGuest ? 'guestDeployment' : 'verifiedDeployment';
		const siteUrl = isGuest ? 'https://orgfarm-d585323017.test1.my.pc-rnd.site.com/ESWguestDeployment1766092125646' : 'https://orgfarm-d585323017.test1.my.pc-rnd.site.com/ESWverifiedDeployment1766092284663';
		
        let script = document.createElement("script");
        script.src = siteUrl + "/assets/js/bootstrap.js";
        script.type = "text/javascript";

        script.onerror = () => {
            console.error("Failed to load bootstrap.js");
        };
        script.onload = () => {
            initEmbeddedMessaging(deploymentName, siteUrl);
        };

        document.body.appendChild(script);
    };

    document.addEventListener("DOMContentLoaded", (event) => {
        // default to guest deployment
        loadInitScript(true);
    });
</script>

</body>  
