<!DOCTYPE html>
<html>
<head>
  <title>STEAM-A Channel Menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=0">
</head> 
<body>
<h1>STEAM-A Channel Menu</h1>
<!--<script type='text/javascript' src='https://service.force.com/embeddedservice/menu/fab.min.js'></script>-->
<script type='text/javascript'>
	var initESW = function(gslbBaseURL) {
		// Required if you want labels in a language that’s different from your user’s context.
		//embedded_svc.menu.settings.language = ''; //For example, enter 'en' or 'en-US'

		// Chat server endpoint URLs.
		embedded_svc.menu.init(
			'https://na44.stmfa.stm.salesforce.com',
			'https://d.la2-stmfa1-0-prd.stmfa.stm.salesforceliveagent.com/chat',
			gslbBaseURL,
			'00DRM000000EtFT',
			'WebUrlTest'
		);
	};

	if (!window.embedded_svc || !window.embedded_svc.menu) {
		var s = document.createElement('script');
		//s.setAttribute('src', 'https://na44.stmfa.stm.salesforce.com/embeddedservice/menu/fab.min.js');
		s.setAttribute('src', 'http://npachpand-wsm.internal.salesforce.com:6109/embeddedservice/menu/fab.min.js');
		s.onload = function() {
			initESW(null);
		};
		document.body.appendChild(s);
	} else {
		//initESW('https://service.force.com');
		initESW('http://npachpand-wsm.internal.salesforce.com:6109');
	}
	
	function notifyMe() {
			Notification.requestPermission(function (permission) {
				doNotify();
			});
		}
		function doNotify() {
			let title = "The Title";
			let t = Date.now() + 120000;    //2 mins in future
			let options = {
			body: 'Hello from JavaScript!',
			data: {prop1:123, prop2:"Steve"},
			lang: 'en-CA',
			icon: './img/calendar-lg.png',
			timestamp: t,
			vibrate: [100, 200, 100]
			}
			let n = new Notification(title, options);

			n.addEventListener('show', function(ev){
			console.log('SHOW', ev.currentTarget.data);
			});
			n.addEventListener('close', function(ev){
			   console.log('CLOSE', ev.currentTarget.body); 
			});
			setTimeout( n.close.bind(n), 3000); //close notification after 3 seconds
		}
</script>
<button onclick="notifyMe()">Click me updated</button>
</body>
</html>
